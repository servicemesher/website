<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1206px" preserveAspectRatio="none" style="width:1328px;height:1206px;" version="1.1" viewBox="0 0 1328 1206" width="1328px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="29.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="341.5" y="108.5625"/><rect fill="#FFFFFF" height="29.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="341.5" y="209.9609"/><rect fill="#FFFFFF" height="110.9648" style="stroke: #383838; stroke-width: 1.0;" width="10" x="341.5" y="321.9258"/><rect fill="#FFFFFF" height="68.832" style="stroke: #383838; stroke-width: 1.0;" width="10" x="341.5" y="515.7227"/><rect fill="#FFFFFF" height="483.4258" style="stroke: #383838; stroke-width: 1.0;" width="10" x="341.5" y="665.0586"/><rect fill="#FFFFFF" height="406.5938" style="stroke: #383838; stroke-width: 1.0;" width="10" x="346.5" y="741.8906"/><line style="stroke: #383838; stroke-width: 1.0;" x1="70" x2="70" y1="34.2969" y2="592.5547"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="70" x2="70" y1="592.5547" y2="633.3594"/><line style="stroke: #383838; stroke-width: 1.0;" x1="70" x2="70" y1="633.3594" y2="1166.4844"/><line style="stroke: #383838; stroke-width: 1.0;" x1="208" x2="208" y1="34.2969" y2="592.5547"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="208" x2="208" y1="592.5547" y2="633.3594"/><line style="stroke: #383838; stroke-width: 1.0;" x1="208" x2="208" y1="633.3594" y2="1166.4844"/><line style="stroke: #383838; stroke-width: 1.0;" x1="346" x2="346" y1="34.2969" y2="592.5547"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="346" x2="346" y1="592.5547" y2="633.3594"/><line style="stroke: #383838; stroke-width: 1.0;" x1="346" x2="346" y1="633.3594" y2="1166.4844"/><line style="stroke: #383838; stroke-width: 1.0;" x1="665.5" x2="665.5" y1="34.2969" y2="592.5547"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="665.5" x2="665.5" y1="592.5547" y2="633.3594"/><line style="stroke: #383838; stroke-width: 1.0;" x1="665.5" x2="665.5" y1="633.3594" y2="1166.4844"/><line style="stroke: #383838; stroke-width: 1.0;" x1="782.5" x2="782.5" y1="34.2969" y2="592.5547"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="782.5" x2="782.5" y1="592.5547" y2="633.3594"/><line style="stroke: #383838; stroke-width: 1.0;" x1="782.5" x2="782.5" y1="633.3594" y2="1166.4844"/><line style="stroke: #383838; stroke-width: 1.0;" x1="954.5" x2="954.5" y1="34.2969" y2="592.5547"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="954.5" x2="954.5" y1="592.5547" y2="633.3594"/><line style="stroke: #383838; stroke-width: 1.0;" x1="954.5" x2="954.5" y1="633.3594" y2="1166.4844"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1135.5" x2="1135.5" y1="34.2969" y2="592.5547"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1135.5" x2="1135.5" y1="592.5547" y2="633.3594"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1135.5" x2="1135.5" y1="633.3594" y2="1166.4844"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1283" x2="1283" y1="34.2969" y2="592.5547"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1283" x2="1283" y1="592.5547" y2="633.3594"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1283" x2="1283" y1="633.3594" y2="1166.4844"/><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="125" x="8" y="3"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="15" y="22.9951">ConfigController</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="125" x="8" y="1165.4844"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="15" y="1185.4795">ConfigController</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="131" x="143" y="3"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="117" x="150" y="22.9951">ServiceController</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="131" x="143" y="1165.4844"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="117" x="150" y="1185.4795">ServiceController</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="125" x="284" y="3"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="291" y="22.9951">DiscoveryServer</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="125" x="284" y="1165.4844"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="291" y="1185.4795">DiscoveryServer</text><path d="M614.5,8 L716.5,8 C721.5,8 721.5,21.1484 721.5,21.1484 C721.5,21.1484 721.5,34.2969 716.5,34.2969 L614.5,34.2969 C609.5,34.2969 609.5,21.1484 609.5,21.1484 C609.5,21.1484 609.5,8 614.5,8 " fill="#F8F8F8" style="stroke: #383838; stroke-width: 2.0;"/><path d="M716.5,8 C711.5,8 711.5,21.1484 711.5,21.1484 C711.5,34.2969 716.5,34.2969 716.5,34.2969 " fill="none" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="614.5" y="25.9951">PushChannel</text><path d="M614.5,1165.4844 L716.5,1165.4844 C721.5,1165.4844 721.5,1178.6328 721.5,1178.6328 C721.5,1178.6328 721.5,1191.7813 716.5,1191.7813 L614.5,1191.7813 C609.5,1191.7813 609.5,1178.6328 609.5,1178.6328 C609.5,1178.6328 609.5,1165.4844 614.5,1165.4844 " fill="#F8F8F8" style="stroke: #383838; stroke-width: 2.0;"/><path d="M716.5,1165.4844 C711.5,1165.4844 711.5,1178.6328 711.5,1178.6328 C711.5,1191.7813 716.5,1191.7813 716.5,1191.7813 " fill="none" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="614.5" y="1183.4795">PushChannel</text><path d="M736.5,8 L828.5,8 C833.5,8 833.5,21.1484 833.5,21.1484 C833.5,21.1484 833.5,34.2969 828.5,34.2969 L736.5,34.2969 C731.5,34.2969 731.5,21.1484 731.5,21.1484 C731.5,21.1484 731.5,8 736.5,8 " fill="#F8F8F8" style="stroke: #383838; stroke-width: 2.0;"/><path d="M828.5,8 C823.5,8 823.5,21.1484 823.5,21.1484 C823.5,34.2969 828.5,34.2969 828.5,34.2969 " fill="none" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="736.5" y="25.9951">PushQueue</text><path d="M736.5,1165.4844 L828.5,1165.4844 C833.5,1165.4844 833.5,1178.6328 833.5,1178.6328 C833.5,1178.6328 833.5,1191.7813 828.5,1191.7813 L736.5,1191.7813 C731.5,1191.7813 731.5,1178.6328 731.5,1178.6328 C731.5,1178.6328 731.5,1165.4844 736.5,1165.4844 " fill="#F8F8F8" style="stroke: #383838; stroke-width: 2.0;"/><path d="M828.5,1165.4844 C823.5,1165.4844 823.5,1178.6328 823.5,1178.6328 C823.5,1191.7813 828.5,1191.7813 828.5,1191.7813 " fill="none" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="736.5" y="1183.4795">PushQueue</text><path d="M848.5,8 L1060.5,8 C1065.5,8 1065.5,21.1484 1065.5,21.1484 C1065.5,21.1484 1065.5,34.2969 1060.5,34.2969 L848.5,34.2969 C843.5,34.2969 843.5,21.1484 843.5,21.1484 C843.5,21.1484 843.5,8 848.5,8 " fill="#F8F8F8" style="stroke: #383838; stroke-width: 2.0;"/><path d="M1060.5,8 C1055.5,8 1055.5,21.1484 1055.5,21.1484 C1055.5,34.2969 1060.5,34.2969 1060.5,34.2969 " fill="none" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="202" x="848.5" y="25.9951">XdsConnection.pushChannel</text><path d="M848.5,1165.4844 L1060.5,1165.4844 C1065.5,1165.4844 1065.5,1178.6328 1065.5,1178.6328 C1065.5,1178.6328 1065.5,1191.7813 1060.5,1191.7813 L848.5,1191.7813 C843.5,1191.7813 843.5,1178.6328 843.5,1178.6328 C843.5,1178.6328 843.5,1165.4844 848.5,1165.4844 " fill="#F8F8F8" style="stroke: #383838; stroke-width: 2.0;"/><path d="M1060.5,1165.4844 C1055.5,1165.4844 1055.5,1178.6328 1055.5,1178.6328 C1055.5,1191.7813 1060.5,1191.7813 1060.5,1191.7813 " fill="none" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="202" x="848.5" y="1183.4795">XdsConnection.pushChannel</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="120" x="1075.5" y="3"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="106" x="1082.5" y="22.9951">XdsConnection</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="120" x="1075.5" y="1165.4844"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="106" x="1082.5" y="1185.4795">XdsConnection</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="55" x="1256" y="3"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="1263" y="22.9951">Envoy</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="55" x="1256" y="1165.4844"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="1263" y="1185.4795">Envoy</text><rect fill="#FFFFFF" height="29.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="341.5" y="108.5625"/><rect fill="#FFFFFF" height="29.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="341.5" y="209.9609"/><rect fill="#FFFFFF" height="110.9648" style="stroke: #383838; stroke-width: 1.0;" width="10" x="341.5" y="321.9258"/><rect fill="#FFFFFF" height="68.832" style="stroke: #383838; stroke-width: 1.0;" width="10" x="341.5" y="515.7227"/><rect fill="#FFFFFF" height="483.4258" style="stroke: #383838; stroke-width: 1.0;" width="10" x="341.5" y="665.0586"/><rect fill="#FFFFFF" height="406.5938" style="stroke: #383838; stroke-width: 1.0;" width="10" x="346.5" y="741.8906"/><rect fill="#EEEEEE" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1313" x="3" y="64.8633"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1316" y1="64.8633" y2="64.8633"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1316" y1="67.8633" y2="67.8633"/><rect fill="#EEEEEE" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="133" x="593" y="54.2969"/><text fill="#000000" font-family="FG Virgil" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="114" x="599" y="70.3638">Service Change</text><polygon fill="#383838" points="329.5,104.5625,339.5,108.5625,329.5,112.5625,333.5,108.5625" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="208.5" x2="335.5" y1="108.5625" y2="108.5625"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="215.5" y="103.4966">ConfigUpdate</text><polygon fill="#383838" points="653.5,133.6953,663.5,137.6953,653.5,141.6953,657.5,137.6953" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="346.5" x2="659.5" y1="137.6953" y2="137.6953"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="173" x="353.5" y="132.6294">PushRequest(ServiceEntry)</text><rect fill="#EEEEEE" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1313" x="3" y="166.2617"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1316" y1="166.2617" y2="166.2617"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1316" y1="169.2617" y2="169.2617"/><rect fill="#EEEEEE" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="128" x="595.5" y="155.6953"/><text fill="#000000" font-family="FG Virgil" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="109" x="601.5" y="171.7622">Config Change</text><polygon fill="#383838" points="329.5,205.9609,339.5,209.9609,329.5,213.9609,333.5,209.9609" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="70.5" x2="335.5" y1="209.9609" y2="209.9609"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="77.5" y="204.895">ConfigUpdate</text><polygon fill="#383838" points="653.5,235.0938,663.5,239.0938,653.5,243.0938,657.5,239.0938" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="346.5" x2="659.5" y1="239.0938" y2="239.0938"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="211" x="353.5" y="234.0278">PushRequest(Routing Rules, etc.)</text><rect fill="#EEEEEE" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1313" x="3" y="267.6602"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1316" y1="267.6602" y2="267.6602"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1316" y1="270.6602" y2="270.6602"/><rect fill="#EEEEEE" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="97" x="611" y="257.0938"/><text fill="#000000" font-family="FG Virgil" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="617" y="273.1606">debounce</text><polygon fill="#383838" points="653.5,317.9258,663.5,321.9258,653.5,325.9258,657.5,321.9258" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="351.5" x2="659.5" y1="321.9258" y2="321.9258"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="358.5" y="316.8599">GetPushRequest</text><path d="M77,295.2266 L77,335.2266 L336,335.2266 L336,305.2266 L326,295.2266 L77,295.2266 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><path d="M326,295.2266 L326,305.2266 L336,305.2266 L326,295.2266 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="238" x="83" y="312.2935">pilot/pkg/proxy/envoy/v2/discovery.go</text><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="83" y="327.4263">DiscoveryServer.debounce</text><polygon fill="#383838" points="362.5,357.625,352.5,361.625,362.5,365.625,358.5,361.625" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="356.5" x2="664.5" y1="361.625" y2="361.625"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="368.5" y="356.5591">PushRequest</text><line style="stroke: #383838; stroke-width: 1.0;" x1="351.5" x2="393.5" y1="390.7578" y2="390.7578"/><line style="stroke: #383838; stroke-width: 1.0;" x1="393.5" x2="393.5" y1="390.7578" y2="403.7578"/><line style="stroke: #383838; stroke-width: 1.0;" x1="352.5" x2="393.5" y1="403.7578" y2="403.7578"/><polygon fill="#383838" points="362.5,399.7578,352.5,403.7578,362.5,407.7578,358.5,403.7578" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="358.5" y="385.6919">MergePushRequest</text><polygon fill="#383838" points="770.5,428.8906,780.5,432.8906,770.5,436.8906,774.5,432.8906" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="346.5" x2="776.5" y1="432.8906" y2="432.8906"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="353.5" y="427.8247">Enqueue(XdsConnection,PushRequest)</text><rect fill="#EEEEEE" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1313" x="3" y="461.457"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1316" y1="461.457" y2="461.457"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1316" y1="464.457" y2="464.457"/><rect fill="#EEEEEE" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="113" x="603" y="450.8906"/><text fill="#000000" font-family="FG Virgil" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="89" x="609" y="466.9575">sendPushes</text><polygon fill="#383838" points="770.5,511.7227,780.5,515.7227,770.5,519.7227,774.5,515.7227" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="351.5" x2="776.5" y1="515.7227" y2="515.7227"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="358.5" y="510.6567">Dequeue</text><path d="M77,489.0234 L77,529.0234 L336,529.0234 L336,499.0234 L326,489.0234 L77,489.0234 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><path d="M326,489.0234 L326,499.0234 L336,499.0234 L326,489.0234 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="238" x="83" y="506.0903">pilot/pkg/proxy/envoy/v2/discovery.go</text><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="83" y="521.2231">DiscoveryServer.sendPushes</text><polygon fill="#383838" points="362.5,551.4219,352.5,555.4219,362.5,559.4219,358.5,555.4219" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="356.5" x2="781.5" y1="555.4219" y2="555.4219"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="368.5" y="550.356">XdsConnection,PushRequest</text><polygon fill="#383838" points="942.5,580.5547,952.5,584.5547,942.5,588.5547,946.5,584.5547" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="346.5" x2="948.5" y1="584.5547" y2="584.5547"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="353.5" y="579.4888">XdsEvent</text><text fill="#000000" font-family="FG Virgil" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="679" y="616.7651"/><polygon fill="#383838" points="942.5,661.0586,952.5,665.0586,942.5,669.0586,946.5,665.0586" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="351.5" x2="948.5" y1="665.0586" y2="665.0586"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="358.5" y="659.9927">GetPushEvent</text><path d="M18,638.3594 L18,678.3594 L336,678.3594 L336,648.3594 L326,638.3594 L18,638.3594 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><path d="M326,638.3594 L326,648.3594 L336,648.3594 L326,638.3594 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="24" y="655.4263">pilot/pkg/proxy/envoy/v2/ads.go</text><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="297" x="24" y="670.5591">DiscoveryServer.StreamAggregatedResources</text><polygon fill="#383838" points="362.5,700.7578,352.5,704.7578,362.5,708.7578,358.5,704.7578" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="356.5" x2="953.5" y1="704.7578" y2="704.7578"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="368.5" y="699.6919">PushEvent</text><line style="stroke: #383838; stroke-width: 1.0;" x1="351.5" x2="398.5" y1="728.8906" y2="728.8906"/><line style="stroke: #383838; stroke-width: 1.0;" x1="398.5" x2="398.5" y1="728.8906" y2="741.8906"/><line style="stroke: #383838; stroke-width: 1.0;" x1="357.5" x2="398.5" y1="741.8906" y2="741.8906"/><polygon fill="#383838" points="367.5,737.8906,357.5,741.8906,367.5,745.8906,363.5,741.8906" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="295" x="363.5" y="723.8247">pushConnection(XdsConnection,PushRequest)</text><line style="stroke: #383838; stroke-width: 1.0;" x1="356.5" x2="398.5" y1="776.0234" y2="776.0234"/><line style="stroke: #383838; stroke-width: 1.0;" x1="398.5" x2="398.5" y1="776.0234" y2="789.0234"/><line style="stroke: #383838; stroke-width: 1.0;" x1="357.5" x2="398.5" y1="789.0234" y2="789.0234"/><polygon fill="#383838" points="367.5,785.0234,357.5,789.0234,367.5,793.0234,363.5,789.0234" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="363.5" y="770.9575">pushCDS</text><polygon fill="#383838" points="1123.5,814.1563,1133.5,818.1563,1123.5,822.1563,1127.5,818.1563" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="356.5" x2="1129.5" y1="818.1563" y2="818.1563"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="363.5" y="813.0903">send(DiscoveryResponse)</text><polygon fill="#383838" points="1271.5,843.2891,1281.5,847.2891,1271.5,851.2891,1275.5,847.2891" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1135.5" x2="1277.5" y1="847.2891" y2="847.2891"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="1142.5" y="842.2231">DiscoveryResponse</text><line style="stroke: #383838; stroke-width: 1.0;" x1="356.5" x2="398.5" y1="876.4219" y2="876.4219"/><line style="stroke: #383838; stroke-width: 1.0;" x1="398.5" x2="398.5" y1="876.4219" y2="889.4219"/><line style="stroke: #383838; stroke-width: 1.0;" x1="357.5" x2="398.5" y1="889.4219" y2="889.4219"/><polygon fill="#383838" points="367.5,885.4219,357.5,889.4219,367.5,893.4219,363.5,889.4219" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="363.5" y="871.356">pushEDS</text><polygon fill="#383838" points="1123.5,914.5547,1133.5,918.5547,1123.5,922.5547,1127.5,918.5547" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="356.5" x2="1129.5" y1="918.5547" y2="918.5547"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="363.5" y="913.4888">send(DiscoveryResponse)</text><polygon fill="#383838" points="1271.5,943.6875,1281.5,947.6875,1271.5,951.6875,1275.5,947.6875" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1135.5" x2="1277.5" y1="947.6875" y2="947.6875"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="1142.5" y="942.6216">DiscoveryResponse</text><line style="stroke: #383838; stroke-width: 1.0;" x1="356.5" x2="398.5" y1="976.8203" y2="976.8203"/><line style="stroke: #383838; stroke-width: 1.0;" x1="398.5" x2="398.5" y1="976.8203" y2="989.8203"/><line style="stroke: #383838; stroke-width: 1.0;" x1="357.5" x2="398.5" y1="989.8203" y2="989.8203"/><polygon fill="#383838" points="367.5,985.8203,357.5,989.8203,367.5,993.8203,363.5,989.8203" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="363.5" y="971.7544">pushLDS</text><polygon fill="#383838" points="1123.5,1014.9531,1133.5,1018.9531,1123.5,1022.9531,1127.5,1018.9531" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="356.5" x2="1129.5" y1="1018.9531" y2="1018.9531"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="363.5" y="1013.8872">send(DiscoveryResponse)</text><polygon fill="#383838" points="1271.5,1044.0859,1281.5,1048.0859,1271.5,1052.0859,1275.5,1048.0859" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1135.5" x2="1277.5" y1="1048.0859" y2="1048.0859"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="1142.5" y="1043.02">DiscoveryResponse</text><line style="stroke: #383838; stroke-width: 1.0;" x1="356.5" x2="398.5" y1="1077.2188" y2="1077.2188"/><line style="stroke: #383838; stroke-width: 1.0;" x1="398.5" x2="398.5" y1="1077.2188" y2="1090.2188"/><line style="stroke: #383838; stroke-width: 1.0;" x1="357.5" x2="398.5" y1="1090.2188" y2="1090.2188"/><polygon fill="#383838" points="367.5,1086.2188,357.5,1090.2188,367.5,1094.2188,363.5,1090.2188" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="363.5" y="1072.1528">pushRoute</text><polygon fill="#383838" points="1123.5,1115.3516,1133.5,1119.3516,1123.5,1123.3516,1127.5,1119.3516" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="356.5" x2="1129.5" y1="1119.3516" y2="1119.3516"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="363.5" y="1114.2856">send(DiscoveryResponse)</text><polygon fill="#383838" points="1271.5,1144.4844,1281.5,1148.4844,1271.5,1152.4844,1275.5,1148.4844" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1135.5" x2="1277.5" y1="1148.4844" y2="1148.4844"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="1142.5" y="1143.4185">DiscoveryResponse</text><!--MD5=[cd78cd4a68c7cb2c409a517f78431db2]
@startuml
skinparam monochrome true
skinparam packageStyle rect
skinparam defaultFontName FG Virgil
skinparam shadowing false

queue PushChannel
queue PushQueue
queue XdsConnection.pushChannel

participant ConfigController
participant ServiceController
participant DiscoveryServer
participant PushChannel
participant PushQueue
participant XdsConnection.pushChannel
participant XdsConnection
participant Envoy

== Service Change ==

ServiceController - -> DiscoveryServer:ConfigUpdate
activate DiscoveryServer
DiscoveryServer -> PushChannel:PushRequest(ServiceEntry)
deactivate DiscoveryServer

== Config Change ==
ConfigController - -> DiscoveryServer:ConfigUpdate
activate DiscoveryServer
DiscoveryServer -> PushChannel:PushRequest(Routing Rules, etc.)
deactivate DiscoveryServer

== debounce  ==
DiscoveryServer -> PushChannel:GetPushRequest
note left
    pilot/pkg/proxy/envoy/v2/discovery.go
    DiscoveryServer.debounce
end note
activate DiscoveryServer
return PushRequest
DiscoveryServer -> DiscoveryServer:MergePushRequest
DiscoveryServer -> PushQueue:Enqueue(XdsConnection,PushRequest)
deactivate DiscoveryServer

== sendPushes  ==
DiscoveryServer -> PushQueue:Dequeue
note left
    pilot/pkg/proxy/envoy/v2/discovery.go
    DiscoveryServer.sendPushes
end note
activate DiscoveryServer
return XdsConnection,PushRequest
DiscoveryServer -> XdsConnection.pushChannel:XdsEvent
deactivate DiscoveryServer

... ...
DiscoveryServer -> XdsConnection.pushChannel:GetPushEvent
note left
    pilot/pkg/proxy/envoy/v2/ads.go
    DiscoveryServer.StreamAggregatedResources
end note
activate DiscoveryServer
return PushEvent

DiscoveryServer -> DiscoveryServer:pushConnection(XdsConnection,PushRequest)
activate DiscoveryServer
DiscoveryServer -> DiscoveryServer:pushCDS
DiscoveryServer -> XdsConnection:send(DiscoveryResponse)
XdsConnection -> Envoy:DiscoveryResponse

DiscoveryServer -> DiscoveryServer:pushEDS
DiscoveryServer -> XdsConnection:send(DiscoveryResponse)
XdsConnection -> Envoy:DiscoveryResponse

DiscoveryServer -> DiscoveryServer:pushLDS
DiscoveryServer -> XdsConnection:send(DiscoveryResponse)
XdsConnection -> Envoy:DiscoveryResponse

DiscoveryServer -> DiscoveryServer:pushRoute
DiscoveryServer -> XdsConnection:send(DiscoveryResponse)
XdsConnection -> Envoy:DiscoveryResponse

deactivate DiscoveryServer
deactivate DiscoveryServer
@enduml

PlantUML version 1.2019.12beta6(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.7.0_25-b15
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>