<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2509px" preserveAspectRatio="none" style="width:1655px;height:2509px;" version="1.1" viewBox="0 0 1655 2509" width="1655px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="29.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="477.5" y="633.4922"/><rect fill="#FFFFFF" height="29.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="477.5" y="734.8906"/><rect fill="#FFFFFF" height="110.9648" style="stroke: #383838; stroke-width: 1.0;" width="10" x="477.5" y="846.8555"/><rect fill="#FFFFFF" height="68.832" style="stroke: #383838; stroke-width: 1.0;" width="10" x="477.5" y="1040.6523"/><rect fill="#FFFFFF" height="483.4258" style="stroke: #383838; stroke-width: 1.0;" width="10" x="477.5" y="1189.9883"/><rect fill="#FFFFFF" height="406.5938" style="stroke: #383838; stroke-width: 1.0;" width="10" x="482.5" y="1266.8203"/><rect fill="#FFFFFF" height="524.8398" style="stroke: #383838; stroke-width: 1.0;" width="10" x="477.5" y="1934.7148"/><rect fill="#FFFFFF" height="463.1406" style="stroke: #000000; stroke-width: 2.0;" width="1223.5" x="410" y="1989.4141"/><rect fill="#FFFFFF" height="115.2031" style="stroke: none; stroke-width: 1.0;" width="1223.5" x="410" y="2106.9453"/><rect fill="#FFFFFF" height="115.2031" style="stroke: none; stroke-width: 1.0;" width="1223.5" x="410" y="2222.1484"/><rect fill="#FFFFFF" height="115.2031" style="stroke: none; stroke-width: 1.0;" width="1223.5" x="410" y="2337.3516"/><line style="stroke: #383838; stroke-width: 1.0;" x1="51" x2="51" y1="34.2969" y2="419.8906"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="51" x2="51" y1="419.8906" y2="460.6953"/><line style="stroke: #383838; stroke-width: 1.0;" x1="51" x2="51" y1="460.6953" y2="1117.4844"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="51" x2="51" y1="1117.4844" y2="1158.2891"/><line style="stroke: #383838; stroke-width: 1.0;" x1="51" x2="51" y1="1158.2891" y2="1862.2109"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="51" x2="51" y1="1862.2109" y2="1903.0156"/><line style="stroke: #383838; stroke-width: 1.0;" x1="51" x2="51" y1="1903.0156" y2="2469.5547"/><line style="stroke: #383838; stroke-width: 1.0;" x1="167" x2="167" y1="34.2969" y2="419.8906"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="167" x2="167" y1="419.8906" y2="460.6953"/><line style="stroke: #383838; stroke-width: 1.0;" x1="167" x2="167" y1="460.6953" y2="1117.4844"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="167" x2="167" y1="1117.4844" y2="1158.2891"/><line style="stroke: #383838; stroke-width: 1.0;" x1="167" x2="167" y1="1158.2891" y2="1862.2109"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="167" x2="167" y1="1862.2109" y2="1903.0156"/><line style="stroke: #383838; stroke-width: 1.0;" x1="167" x2="167" y1="1903.0156" y2="2469.5547"/><line style="stroke: #383838; stroke-width: 1.0;" x1="305" x2="305" y1="34.2969" y2="419.8906"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="305" x2="305" y1="419.8906" y2="460.6953"/><line style="stroke: #383838; stroke-width: 1.0;" x1="305" x2="305" y1="460.6953" y2="1117.4844"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="305" x2="305" y1="1117.4844" y2="1158.2891"/><line style="stroke: #383838; stroke-width: 1.0;" x1="305" x2="305" y1="1158.2891" y2="1862.2109"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="305" x2="305" y1="1862.2109" y2="1903.0156"/><line style="stroke: #383838; stroke-width: 1.0;" x1="305" x2="305" y1="1903.0156" y2="2469.5547"/><line style="stroke: #383838; stroke-width: 1.0;" x1="482" x2="482" y1="34.2969" y2="419.8906"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="482" x2="482" y1="419.8906" y2="460.6953"/><line style="stroke: #383838; stroke-width: 1.0;" x1="482" x2="482" y1="460.6953" y2="1117.4844"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="482" x2="482" y1="1117.4844" y2="1158.2891"/><line style="stroke: #383838; stroke-width: 1.0;" x1="482" x2="482" y1="1158.2891" y2="1862.2109"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="482" x2="482" y1="1862.2109" y2="1903.0156"/><line style="stroke: #383838; stroke-width: 1.0;" x1="482" x2="482" y1="1903.0156" y2="2469.5547"/><line style="stroke: #383838; stroke-width: 1.0;" x1="801.5" x2="801.5" y1="34.2969" y2="419.8906"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="801.5" x2="801.5" y1="419.8906" y2="460.6953"/><line style="stroke: #383838; stroke-width: 1.0;" x1="801.5" x2="801.5" y1="460.6953" y2="1117.4844"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="801.5" x2="801.5" y1="1117.4844" y2="1158.2891"/><line style="stroke: #383838; stroke-width: 1.0;" x1="801.5" x2="801.5" y1="1158.2891" y2="1862.2109"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="801.5" x2="801.5" y1="1862.2109" y2="1903.0156"/><line style="stroke: #383838; stroke-width: 1.0;" x1="801.5" x2="801.5" y1="1903.0156" y2="2469.5547"/><line style="stroke: #383838; stroke-width: 1.0;" x1="918.5" x2="918.5" y1="34.2969" y2="419.8906"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="918.5" x2="918.5" y1="419.8906" y2="460.6953"/><line style="stroke: #383838; stroke-width: 1.0;" x1="918.5" x2="918.5" y1="460.6953" y2="1117.4844"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="918.5" x2="918.5" y1="1117.4844" y2="1158.2891"/><line style="stroke: #383838; stroke-width: 1.0;" x1="918.5" x2="918.5" y1="1158.2891" y2="1862.2109"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="918.5" x2="918.5" y1="1862.2109" y2="1903.0156"/><line style="stroke: #383838; stroke-width: 1.0;" x1="918.5" x2="918.5" y1="1903.0156" y2="2469.5547"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1090.5" x2="1090.5" y1="34.2969" y2="419.8906"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1090.5" x2="1090.5" y1="419.8906" y2="460.6953"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1090.5" x2="1090.5" y1="460.6953" y2="1117.4844"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1090.5" x2="1090.5" y1="1117.4844" y2="1158.2891"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1090.5" x2="1090.5" y1="1158.2891" y2="1862.2109"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1090.5" x2="1090.5" y1="1862.2109" y2="1903.0156"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1090.5" x2="1090.5" y1="1903.0156" y2="2469.5547"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1271.5" x2="1271.5" y1="34.2969" y2="419.8906"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1271.5" x2="1271.5" y1="419.8906" y2="460.6953"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1271.5" x2="1271.5" y1="460.6953" y2="1117.4844"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1271.5" x2="1271.5" y1="1117.4844" y2="1158.2891"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1271.5" x2="1271.5" y1="1158.2891" y2="1862.2109"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1271.5" x2="1271.5" y1="1862.2109" y2="1903.0156"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1271.5" x2="1271.5" y1="1903.0156" y2="2469.5547"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1393.5" x2="1393.5" y1="34.2969" y2="419.8906"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1393.5" x2="1393.5" y1="419.8906" y2="460.6953"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1393.5" x2="1393.5" y1="460.6953" y2="1117.4844"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1393.5" x2="1393.5" y1="1117.4844" y2="1158.2891"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1393.5" x2="1393.5" y1="1158.2891" y2="1862.2109"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1393.5" x2="1393.5" y1="1862.2109" y2="1903.0156"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1393.5" x2="1393.5" y1="1903.0156" y2="2469.5547"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1507.5" x2="1507.5" y1="34.2969" y2="419.8906"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1507.5" x2="1507.5" y1="419.8906" y2="460.6953"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1507.5" x2="1507.5" y1="460.6953" y2="1117.4844"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1507.5" x2="1507.5" y1="1117.4844" y2="1158.2891"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1507.5" x2="1507.5" y1="1158.2891" y2="1862.2109"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1507.5" x2="1507.5" y1="1862.2109" y2="1903.0156"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1507.5" x2="1507.5" y1="1903.0156" y2="2469.5547"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1595.5" x2="1595.5" y1="34.2969" y2="419.8906"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1595.5" x2="1595.5" y1="419.8906" y2="460.6953"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1595.5" x2="1595.5" y1="460.6953" y2="1117.4844"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1595.5" x2="1595.5" y1="1117.4844" y2="1158.2891"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1595.5" x2="1595.5" y1="1158.2891" y2="1862.2109"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1595.5" x2="1595.5" y1="1862.2109" y2="1903.0156"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1595.5" x2="1595.5" y1="1903.0156" y2="2469.5547"/><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="87" x="8" y="3"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="15" y="22.9951">PilotServer</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="87" x="8" y="2468.5547"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="15" y="2488.5498">PilotServer</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="125" x="105" y="3"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="112" y="22.9951">ConfigController</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="125" x="105" y="2468.5547"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="112" y="2488.5498">ConfigController</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="131" x="240" y="3"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="117" x="247" y="22.9951">ServiceController</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="131" x="240" y="2468.5547"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="117" x="247" y="2488.5498">ServiceController</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="125" x="420" y="3"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="427" y="22.9951">DiscoveryServer</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="125" x="420" y="2468.5547"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="111" x="427" y="2488.5498">DiscoveryServer</text><path d="M750.5,8 L852.5,8 C857.5,8 857.5,21.1484 857.5,21.1484 C857.5,21.1484 857.5,34.2969 852.5,34.2969 L750.5,34.2969 C745.5,34.2969 745.5,21.1484 745.5,21.1484 C745.5,21.1484 745.5,8 750.5,8 " fill="#F8F8F8" style="stroke: #383838; stroke-width: 2.0;"/><path d="M852.5,8 C847.5,8 847.5,21.1484 847.5,21.1484 C847.5,34.2969 852.5,34.2969 852.5,34.2969 " fill="none" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="750.5" y="25.9951">PushChannel</text><path d="M750.5,2468.5547 L852.5,2468.5547 C857.5,2468.5547 857.5,2481.7031 857.5,2481.7031 C857.5,2481.7031 857.5,2494.8516 852.5,2494.8516 L750.5,2494.8516 C745.5,2494.8516 745.5,2481.7031 745.5,2481.7031 C745.5,2481.7031 745.5,2468.5547 750.5,2468.5547 " fill="#F8F8F8" style="stroke: #383838; stroke-width: 2.0;"/><path d="M852.5,2468.5547 C847.5,2468.5547 847.5,2481.7031 847.5,2481.7031 C847.5,2494.8516 852.5,2494.8516 852.5,2494.8516 " fill="none" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="750.5" y="2486.5498">PushChannel</text><path d="M872.5,8 L964.5,8 C969.5,8 969.5,21.1484 969.5,21.1484 C969.5,21.1484 969.5,34.2969 964.5,34.2969 L872.5,34.2969 C867.5,34.2969 867.5,21.1484 867.5,21.1484 C867.5,21.1484 867.5,8 872.5,8 " fill="#F8F8F8" style="stroke: #383838; stroke-width: 2.0;"/><path d="M964.5,8 C959.5,8 959.5,21.1484 959.5,21.1484 C959.5,34.2969 964.5,34.2969 964.5,34.2969 " fill="none" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="872.5" y="25.9951">PushQueue</text><path d="M872.5,2468.5547 L964.5,2468.5547 C969.5,2468.5547 969.5,2481.7031 969.5,2481.7031 C969.5,2481.7031 969.5,2494.8516 964.5,2494.8516 L872.5,2494.8516 C867.5,2494.8516 867.5,2481.7031 867.5,2481.7031 C867.5,2481.7031 867.5,2468.5547 872.5,2468.5547 " fill="#F8F8F8" style="stroke: #383838; stroke-width: 2.0;"/><path d="M964.5,2468.5547 C959.5,2468.5547 959.5,2481.7031 959.5,2481.7031 C959.5,2494.8516 964.5,2494.8516 964.5,2494.8516 " fill="none" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="82" x="872.5" y="2486.5498">PushQueue</text><path d="M984.5,8 L1196.5,8 C1201.5,8 1201.5,21.1484 1201.5,21.1484 C1201.5,21.1484 1201.5,34.2969 1196.5,34.2969 L984.5,34.2969 C979.5,34.2969 979.5,21.1484 979.5,21.1484 C979.5,21.1484 979.5,8 984.5,8 " fill="#F8F8F8" style="stroke: #383838; stroke-width: 2.0;"/><path d="M1196.5,8 C1191.5,8 1191.5,21.1484 1191.5,21.1484 C1191.5,34.2969 1196.5,34.2969 1196.5,34.2969 " fill="none" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="202" x="984.5" y="25.9951">XdsConnection.pushChannel</text><path d="M984.5,2468.5547 L1196.5,2468.5547 C1201.5,2468.5547 1201.5,2481.7031 1201.5,2481.7031 C1201.5,2481.7031 1201.5,2494.8516 1196.5,2494.8516 L984.5,2494.8516 C979.5,2494.8516 979.5,2481.7031 979.5,2481.7031 C979.5,2481.7031 979.5,2468.5547 984.5,2468.5547 " fill="#F8F8F8" style="stroke: #383838; stroke-width: 2.0;"/><path d="M1196.5,2468.5547 C1191.5,2468.5547 1191.5,2481.7031 1191.5,2481.7031 C1191.5,2494.8516 1196.5,2494.8516 1196.5,2494.8516 " fill="none" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="202" x="984.5" y="2486.5498">XdsConnection.pushChannel</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="120" x="1211.5" y="3"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="106" x="1218.5" y="22.9951">XdsConnection</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="120" x="1211.5" y="2468.5547"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="106" x="1218.5" y="2488.5498">XdsConnection</text><path d="M1346.5,8 L1441.5,8 C1446.5,8 1446.5,21.1484 1446.5,21.1484 C1446.5,21.1484 1446.5,34.2969 1441.5,34.2969 L1346.5,34.2969 C1341.5,34.2969 1341.5,21.1484 1341.5,21.1484 C1341.5,21.1484 1341.5,8 1346.5,8 " fill="#F8F8F8" style="stroke: #383838; stroke-width: 2.0;"/><path d="M1441.5,8 C1436.5,8 1436.5,21.1484 1436.5,21.1484 C1436.5,34.2969 1441.5,34.2969 1441.5,34.2969 " fill="none" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="1346.5" y="25.9951">ReqChannel</text><path d="M1346.5,2468.5547 L1441.5,2468.5547 C1446.5,2468.5547 1446.5,2481.7031 1446.5,2481.7031 C1446.5,2481.7031 1446.5,2494.8516 1441.5,2494.8516 L1346.5,2494.8516 C1341.5,2494.8516 1341.5,2481.7031 1341.5,2481.7031 C1341.5,2481.7031 1341.5,2468.5547 1346.5,2468.5547 " fill="#F8F8F8" style="stroke: #383838; stroke-width: 2.0;"/><path d="M1441.5,2468.5547 C1436.5,2468.5547 1436.5,2481.7031 1436.5,2481.7031 C1436.5,2494.8516 1441.5,2494.8516 1441.5,2494.8516 " fill="none" style="stroke: #383838; stroke-width: 2.0;"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="1346.5" y="2486.5498">ReqChannel</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="102" x="1456.5" y="3"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="88" x="1463.5" y="22.9951">GRPC Server</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="102" x="1456.5" y="2468.5547"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="88" x="1463.5" y="2488.5498">GRPC Server</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="55" x="1568.5" y="3"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="1575.5" y="22.9951">Envoy</text><rect fill="#F8F8F8" height="30.2969" style="stroke: #383838; stroke-width: 1.5;" width="55" x="1568.5" y="2468.5547"/><text fill="#000000" font-family="FG Virgil" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="1575.5" y="2488.5498">Envoy</text><rect fill="#FFFFFF" height="29.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="477.5" y="633.4922"/><rect fill="#FFFFFF" height="29.1328" style="stroke: #383838; stroke-width: 1.0;" width="10" x="477.5" y="734.8906"/><rect fill="#FFFFFF" height="110.9648" style="stroke: #383838; stroke-width: 1.0;" width="10" x="477.5" y="846.8555"/><rect fill="#FFFFFF" height="68.832" style="stroke: #383838; stroke-width: 1.0;" width="10" x="477.5" y="1040.6523"/><rect fill="#FFFFFF" height="483.4258" style="stroke: #383838; stroke-width: 1.0;" width="10" x="477.5" y="1189.9883"/><rect fill="#FFFFFF" height="406.5938" style="stroke: #383838; stroke-width: 1.0;" width="10" x="482.5" y="1266.8203"/><rect fill="#FFFFFF" height="524.8398" style="stroke: #383838; stroke-width: 1.0;" width="10" x="477.5" y="1934.7148"/><rect fill="#EEEEEE" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1640.5" x="3" y="64.8633"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1643.5" y1="64.8633" y2="64.8633"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1643.5" y1="67.8633" y2="67.8633"/><rect fill="#EEEEEE" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="108" x="769.25" y="54.2969"/><text fill="#000000" font-family="FG Virgil" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="89" x="775.25" y="70.3638">Initialization</text><path d="M56,92.4297 L56,117.4297 L261,117.4297 L261,102.4297 L251,92.4297 L56,92.4297 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><path d="M251,92.4297 L251,102.4297 L261,102.4297 L251,92.4297 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="62" y="109.4966">pilot/pkg/bootstrap/server.go</text><polygon fill="#383838" points="155.5,139.6953,165.5,143.6953,155.5,147.6953,159.5,143.6953" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="51.5" x2="161.5" y1="143.6953" y2="143.6953"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="58.5" y="138.6294">Create</text><polygon fill="#383838" points="293.5,168.8281,303.5,172.8281,293.5,176.8281,297.5,172.8281" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="51.5" x2="299.5" y1="172.8281" y2="172.8281"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="58.5" y="167.7622">Create</text><polygon fill="#383838" points="470.5,197.9609,480.5,201.9609,470.5,205.9609,474.5,201.9609" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="51.5" x2="476.5" y1="201.9609" y2="201.9609"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="58.5" y="196.895">Create</text><polygon fill="#383838" points="178.5,227.0938,168.5,231.0938,178.5,235.0938,174.5,231.0938" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="172.5" x2="481.5" y1="231.0938" y2="231.0938"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="184.5" y="226.0278">RegisterEventHandler</text><polygon fill="#383838" points="316.5,256.2266,306.5,260.2266,316.5,264.2266,312.5,260.2266" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="310.5" x2="481.5" y1="260.2266" y2="260.2266"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="322.5" y="255.1606">AppendServiceHandler</text><polygon fill="#383838" points="316.5,285.3594,306.5,289.3594,316.5,293.3594,312.5,289.3594" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="310.5" x2="481.5" y1="289.3594" y2="289.3594"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="322.5" y="284.2935">AppendInstanceHandler</text><rect fill="#EEEEEE" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1640.5" x="3" y="317.9258"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1643.5" y1="317.9258" y2="317.9258"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1643.5" y1="320.9258" y2="320.9258"/><rect fill="#EEEEEE" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="171" x="737.75" y="307.3594"/><text fill="#000000" font-family="FG Virgil" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="152" x="743.75" y="323.4263">Receive Connections</text><polygon fill="#383838" points="1495.5,357.625,1505.5,361.625,1495.5,365.625,1499.5,361.625" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="51.5" x2="1501.5" y1="361.625" y2="361.625"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="58.5" y="356.5591">Create</text><polygon fill="#383838" points="1495.5,397.3242,1505.5,401.3242,1495.5,405.3242,1499.5,401.3242" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="482.5" x2="1501.5" y1="401.3242" y2="401.3242"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="489.5" y="396.2583">RegisterService</text><path d="M218,374.625 L218,414.625 L477,414.625 L477,384.625 L467,374.625 L218,374.625 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><path d="M467,374.625 L467,384.625 L477,384.625 L467,374.625 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="238" x="224" y="391.6919">pilot/pkg/proxy/envoy/v2/discovery.go</text><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="224" y="406.8247">DiscoveryServer.Register</text><text fill="#000000" font-family="FG Virgil" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="827.75" y="444.1011"/><polygon fill="#383838" points="1518.5,477.8281,1508.5,481.8281,1518.5,485.8281,1514.5,481.8281" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1512.5" x2="1595" y1="481.8281" y2="481.8281"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="1524.5" y="476.7622">GRPC</text><polygon fill="#383838" points="493.5,517.5273,483.5,521.5273,493.5,525.5273,489.5,521.5273" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="487.5" x2="1506.5" y1="521.5273" y2="521.5273"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="499.5" y="516.4614">callback</text><path d="M159,494.8281 L159,534.8281 L477,534.8281 L477,504.8281 L467,494.8281 L159,494.8281 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><path d="M467,494.8281 L467,504.8281 L477,504.8281 L467,494.8281 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="165" y="511.895">pilot/pkg/proxy/envoy/v2/ads.go</text><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="297" x="165" y="527.0278">DiscoveryServer.StreamAggregatedResources</text><polygon fill="#383838" points="1259.5,557.2266,1269.5,561.2266,1259.5,565.2266,1263.5,561.2266" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="482.5" x2="1265.5" y1="561.2266" y2="561.2266"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="489.5" y="556.1606">Create</text><rect fill="#EEEEEE" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1640.5" x="3" y="589.793"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1643.5" y1="589.793" y2="589.793"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1643.5" y1="592.793" y2="592.793"/><rect fill="#EEEEEE" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="133" x="756.75" y="579.2266"/><text fill="#000000" font-family="FG Virgil" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="114" x="762.75" y="595.2935">Service Change</text><polygon fill="#383838" points="465.5,629.4922,475.5,633.4922,465.5,637.4922,469.5,633.4922" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="305.5" x2="471.5" y1="633.4922" y2="633.4922"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="312.5" y="628.4263">ConfigUpdate</text><polygon fill="#383838" points="789.5,658.625,799.5,662.625,789.5,666.625,793.5,662.625" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="482.5" x2="795.5" y1="662.625" y2="662.625"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="173" x="489.5" y="657.5591">PushRequest(ServiceEntry)</text><rect fill="#EEEEEE" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1640.5" x="3" y="691.1914"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1643.5" y1="691.1914" y2="691.1914"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1643.5" y1="694.1914" y2="694.1914"/><rect fill="#EEEEEE" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="128" x="759.25" y="680.625"/><text fill="#000000" font-family="FG Virgil" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="109" x="765.25" y="696.6919">Config Change</text><polygon fill="#383838" points="465.5,730.8906,475.5,734.8906,465.5,738.8906,469.5,734.8906" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="167.5" x2="471.5" y1="734.8906" y2="734.8906"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="174.5" y="729.8247">ConfigUpdate</text><polygon fill="#383838" points="789.5,760.0234,799.5,764.0234,789.5,768.0234,793.5,764.0234" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="482.5" x2="795.5" y1="764.0234" y2="764.0234"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="211" x="489.5" y="758.9575">PushRequest(Routing Rules, etc.)</text><rect fill="#EEEEEE" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1640.5" x="3" y="792.5898"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1643.5" y1="792.5898" y2="792.5898"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1643.5" y1="795.5898" y2="795.5898"/><rect fill="#EEEEEE" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="97" x="774.75" y="782.0234"/><text fill="#000000" font-family="FG Virgil" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="780.75" y="798.0903">debounce</text><polygon fill="#383838" points="789.5,842.8555,799.5,846.8555,789.5,850.8555,793.5,846.8555" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="487.5" x2="795.5" y1="846.8555" y2="846.8555"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="106" x="494.5" y="841.7896">GetPushRequest</text><path d="M213,820.1563 L213,860.1563 L472,860.1563 L472,830.1563 L462,820.1563 L213,820.1563 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><path d="M462,820.1563 L462,830.1563 L472,830.1563 L462,820.1563 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="238" x="219" y="837.2231">pilot/pkg/proxy/envoy/v2/discovery.go</text><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="171" x="219" y="852.356">DiscoveryServer.debounce</text><polygon fill="#383838" points="498.5,882.5547,488.5,886.5547,498.5,890.5547,494.5,886.5547" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="492.5" x2="800.5" y1="886.5547" y2="886.5547"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="83" x="504.5" y="881.4888">PushRequest</text><line style="stroke: #383838; stroke-width: 1.0;" x1="487.5" x2="529.5" y1="915.6875" y2="915.6875"/><line style="stroke: #383838; stroke-width: 1.0;" x1="529.5" x2="529.5" y1="915.6875" y2="928.6875"/><line style="stroke: #383838; stroke-width: 1.0;" x1="488.5" x2="529.5" y1="928.6875" y2="928.6875"/><polygon fill="#383838" points="498.5,924.6875,488.5,928.6875,498.5,932.6875,494.5,928.6875" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="494.5" y="910.6216">MergePushRequest</text><polygon fill="#383838" points="906.5,953.8203,916.5,957.8203,906.5,961.8203,910.5,957.8203" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="482.5" x2="912.5" y1="957.8203" y2="957.8203"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="248" x="489.5" y="952.7544">Enqueue(XdsConnection,PushRequest)</text><rect fill="#EEEEEE" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1640.5" x="3" y="986.3867"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1643.5" y1="986.3867" y2="986.3867"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1643.5" y1="989.3867" y2="989.3867"/><rect fill="#EEEEEE" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="113" x="766.75" y="975.8203"/><text fill="#000000" font-family="FG Virgil" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="89" x="772.75" y="991.8872">sendPushes</text><polygon fill="#383838" points="906.5,1036.6523,916.5,1040.6523,906.5,1044.6523,910.5,1040.6523" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="487.5" x2="912.5" y1="1040.6523" y2="1040.6523"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="494.5" y="1035.5864">Dequeue</text><path d="M213,1013.9531 L213,1053.9531 L472,1053.9531 L472,1023.9531 L462,1013.9531 L213,1013.9531 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><path d="M462,1013.9531 L462,1023.9531 L472,1023.9531 L462,1013.9531 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="238" x="219" y="1031.02">pilot/pkg/proxy/envoy/v2/discovery.go</text><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="185" x="219" y="1046.1528">DiscoveryServer.sendPushes</text><polygon fill="#383838" points="498.5,1076.3516,488.5,1080.3516,498.5,1084.3516,494.5,1080.3516" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="492.5" x2="917.5" y1="1080.3516" y2="1080.3516"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="504.5" y="1075.2856">XdsConnection,PushRequest</text><polygon fill="#383838" points="1078.5,1105.4844,1088.5,1109.4844,1078.5,1113.4844,1082.5,1109.4844" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="482.5" x2="1084.5" y1="1109.4844" y2="1109.4844"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="489.5" y="1104.4185">XdsEvent</text><text fill="#000000" font-family="FG Virgil" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="825.75" y="1141.6948"/><polygon fill="#383838" points="1078.5,1185.9883,1088.5,1189.9883,1078.5,1193.9883,1082.5,1189.9883" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="487.5" x2="1084.5" y1="1189.9883" y2="1189.9883"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="494.5" y="1184.9224">GetPushEvent</text><path d="M154,1163.2891 L154,1203.2891 L472,1203.2891 L472,1173.2891 L462,1163.2891 L154,1163.2891 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><path d="M462,1163.2891 L462,1173.2891 L472,1173.2891 L462,1163.2891 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="160" y="1180.356">pilot/pkg/proxy/envoy/v2/ads.go</text><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="297" x="160" y="1195.4888">DiscoveryServer.StreamAggregatedResources</text><polygon fill="#383838" points="498.5,1225.6875,488.5,1229.6875,498.5,1233.6875,494.5,1229.6875" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="492.5" x2="1089.5" y1="1229.6875" y2="1229.6875"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="67" x="504.5" y="1224.6216">PushEvent</text><line style="stroke: #383838; stroke-width: 1.0;" x1="487.5" x2="534.5" y1="1253.8203" y2="1253.8203"/><line style="stroke: #383838; stroke-width: 1.0;" x1="534.5" x2="534.5" y1="1253.8203" y2="1266.8203"/><line style="stroke: #383838; stroke-width: 1.0;" x1="493.5" x2="534.5" y1="1266.8203" y2="1266.8203"/><polygon fill="#383838" points="503.5,1262.8203,493.5,1266.8203,503.5,1270.8203,499.5,1266.8203" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="295" x="499.5" y="1248.7544">pushConnection(XdsConnection,PushRequest)</text><line style="stroke: #383838; stroke-width: 1.0;" x1="492.5" x2="534.5" y1="1300.9531" y2="1300.9531"/><line style="stroke: #383838; stroke-width: 1.0;" x1="534.5" x2="534.5" y1="1300.9531" y2="1313.9531"/><line style="stroke: #383838; stroke-width: 1.0;" x1="493.5" x2="534.5" y1="1313.9531" y2="1313.9531"/><polygon fill="#383838" points="503.5,1309.9531,493.5,1313.9531,503.5,1317.9531,499.5,1313.9531" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="499.5" y="1295.8872">pushCDS</text><polygon fill="#383838" points="1259.5,1339.0859,1269.5,1343.0859,1259.5,1347.0859,1263.5,1343.0859" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="492.5" x2="1265.5" y1="1343.0859" y2="1343.0859"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="499.5" y="1338.02">send(DiscoveryResponse)</text><polygon fill="#383838" points="1584,1368.2188,1594,1372.2188,1584,1376.2188,1588,1372.2188" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1271.5" x2="1590" y1="1372.2188" y2="1372.2188"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="1278.5" y="1367.1528">DiscoveryResponse</text><line style="stroke: #383838; stroke-width: 1.0;" x1="492.5" x2="534.5" y1="1401.3516" y2="1401.3516"/><line style="stroke: #383838; stroke-width: 1.0;" x1="534.5" x2="534.5" y1="1401.3516" y2="1414.3516"/><line style="stroke: #383838; stroke-width: 1.0;" x1="493.5" x2="534.5" y1="1414.3516" y2="1414.3516"/><polygon fill="#383838" points="503.5,1410.3516,493.5,1414.3516,503.5,1418.3516,499.5,1414.3516" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="499.5" y="1396.2856">pushEDS</text><polygon fill="#383838" points="1259.5,1439.4844,1269.5,1443.4844,1259.5,1447.4844,1263.5,1443.4844" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="492.5" x2="1265.5" y1="1443.4844" y2="1443.4844"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="499.5" y="1438.4185">send(DiscoveryResponse)</text><polygon fill="#383838" points="1584,1468.6172,1594,1472.6172,1584,1476.6172,1588,1472.6172" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1271.5" x2="1590" y1="1472.6172" y2="1472.6172"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="1278.5" y="1467.5513">DiscoveryResponse</text><line style="stroke: #383838; stroke-width: 1.0;" x1="492.5" x2="534.5" y1="1501.75" y2="1501.75"/><line style="stroke: #383838; stroke-width: 1.0;" x1="534.5" x2="534.5" y1="1501.75" y2="1514.75"/><line style="stroke: #383838; stroke-width: 1.0;" x1="493.5" x2="534.5" y1="1514.75" y2="1514.75"/><polygon fill="#383838" points="503.5,1510.75,493.5,1514.75,503.5,1518.75,499.5,1514.75" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="499.5" y="1496.6841">pushLDS</text><polygon fill="#383838" points="1259.5,1539.8828,1269.5,1543.8828,1259.5,1547.8828,1263.5,1543.8828" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="492.5" x2="1265.5" y1="1543.8828" y2="1543.8828"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="499.5" y="1538.8169">send(DiscoveryResponse)</text><polygon fill="#383838" points="1584,1569.0156,1594,1573.0156,1584,1577.0156,1588,1573.0156" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1271.5" x2="1590" y1="1573.0156" y2="1573.0156"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="1278.5" y="1567.9497">DiscoveryResponse</text><line style="stroke: #383838; stroke-width: 1.0;" x1="492.5" x2="534.5" y1="1602.1484" y2="1602.1484"/><line style="stroke: #383838; stroke-width: 1.0;" x1="534.5" x2="534.5" y1="1602.1484" y2="1615.1484"/><line style="stroke: #383838; stroke-width: 1.0;" x1="493.5" x2="534.5" y1="1615.1484" y2="1615.1484"/><polygon fill="#383838" points="503.5,1611.1484,493.5,1615.1484,503.5,1619.1484,499.5,1615.1484" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="499.5" y="1597.0825">pushRoute</text><polygon fill="#383838" points="1259.5,1640.2813,1269.5,1644.2813,1259.5,1648.2813,1263.5,1644.2813" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="492.5" x2="1265.5" y1="1644.2813" y2="1644.2813"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="499.5" y="1639.2153">send(DiscoveryResponse)</text><polygon fill="#383838" points="1584,1669.4141,1594,1673.4141,1584,1677.4141,1588,1673.4141" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1271.5" x2="1590" y1="1673.4141" y2="1673.4141"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="1278.5" y="1668.3481">DiscoveryResponse</text><rect fill="#EEEEEE" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1640.5" x="3" y="1701.9805"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1643.5" y1="1701.9805" y2="1701.9805"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1643.5" y1="1704.9805" y2="1704.9805"/><rect fill="#EEEEEE" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="130" x="758.25" y="1691.4141"/><text fill="#000000" font-family="FG Virgil" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="106" x="764.25" y="1707.481">client Request</text><polygon fill="#383838" points="1282.5,1741.6797,1272.5,1745.6797,1282.5,1749.6797,1278.5,1745.6797" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1276.5" x2="1595" y1="1745.6797" y2="1745.6797"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="1288.5" y="1740.6138">DiscoveryRequest</text><polygon fill="#383838" points="1259.5,1781.3789,1269.5,1785.3789,1259.5,1789.3789,1263.5,1785.3789" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="482.5" x2="1265.5" y1="1785.3789" y2="1785.3789"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="49" x="489.5" y="1780.313">Receive</text><path d="M255,1758.6797 L255,1798.6797 L477,1798.6797 L477,1768.6797 L467,1758.6797 L255,1758.6797 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><path d="M467,1758.6797 L467,1768.6797 L477,1768.6797 L467,1758.6797 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="261" y="1775.7466">pilot/pkg/proxy/envoy/v2/ads.go</text><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="261" y="1790.8794">receiveThread</text><polygon fill="#383838" points="493.5,1821.0781,483.5,1825.0781,493.5,1829.0781,489.5,1825.0781" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="487.5" x2="1270.5" y1="1825.0781" y2="1825.0781"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="499.5" y="1820.0122">DiscoveryRequest</text><polygon fill="#383838" points="1382,1850.2109,1392,1854.2109,1382,1858.2109,1386,1854.2109" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="482.5" x2="1388" y1="1854.2109" y2="1854.2109"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="489.5" y="1849.145">DiscoveryRequest</text><text fill="#000000" font-family="FG Virgil" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="825.75" y="1886.4214"/><polygon fill="#383838" points="1382,1930.7148,1392,1934.7148,1382,1938.7148,1386,1934.7148" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="487.5" x2="1388" y1="1934.7148" y2="1934.7148"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="494.5" y="1929.6489">GetRequest</text><path d="M250,1908.0156 L250,1948.0156 L472,1948.0156 L472,1918.0156 L462,1908.0156 L250,1908.0156 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><path d="M462,1908.0156 L462,1918.0156 L472,1918.0156 L462,1908.0156 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="256" y="1925.0825">pilot/pkg/proxy/envoy/v2/ads.go</text><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="189" x="256" y="1940.2153">StreamAggregatedResources</text><polygon fill="#383838" points="498.5,1970.4141,488.5,1974.4141,498.5,1978.4141,494.5,1974.4141" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="492.5" x2="1393" y1="1974.4141" y2="1974.4141"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="504.5" y="1969.3481">DiscoveryRequest</text><path d="M410,1989.4141 L474,1989.4141 L474,1996.4141 L464,2006.4141 L410,2006.4141 L410,1989.4141 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="463.1406" style="stroke: #000000; stroke-width: 2.0;" width="1223.5" x="410" y="1989.4141"/><text fill="#000000" font-family="FG Virgil" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="425" y="2002.481">alt</text><text fill="#000000" font-family="FG Virgil" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="91" x="489" y="2001.6245">[Cluster Type]</text><line style="stroke: #383838; stroke-width: 1.0;" x1="487.5" x2="529.5" y1="2027.6797" y2="2027.6797"/><line style="stroke: #383838; stroke-width: 1.0;" x1="529.5" x2="529.5" y1="2027.6797" y2="2040.6797"/><line style="stroke: #383838; stroke-width: 1.0;" x1="488.5" x2="529.5" y1="2040.6797" y2="2040.6797"/><polygon fill="#383838" points="498.5,2036.6797,488.5,2040.6797,498.5,2044.6797,494.5,2040.6797" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="494.5" y="2022.6138">pushCDS</text><polygon fill="#383838" points="1259.5,2065.8125,1269.5,2069.8125,1259.5,2073.8125,1263.5,2069.8125" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="487.5" x2="1265.5" y1="2069.8125" y2="2069.8125"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="494.5" y="2064.7466">send(DiscoveryResponse)</text><polygon fill="#383838" points="1584,2094.9453,1594,2098.9453,1584,2102.9453,1588,2098.9453" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1271.5" x2="1590" y1="2098.9453" y2="2098.9453"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="1278.5" y="2093.8794">DiscoveryResponse</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="410" x2="1633.5" y1="2107.9453" y2="2107.9453"/><text fill="#000000" font-family="FG Virgil" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="118" x="415" y="2118.1558">[Listener Request]</text><line style="stroke: #383838; stroke-width: 1.0;" x1="487.5" x2="529.5" y1="2142.8828" y2="2142.8828"/><line style="stroke: #383838; stroke-width: 1.0;" x1="529.5" x2="529.5" y1="2142.8828" y2="2155.8828"/><line style="stroke: #383838; stroke-width: 1.0;" x1="488.5" x2="529.5" y1="2155.8828" y2="2155.8828"/><polygon fill="#383838" points="498.5,2151.8828,488.5,2155.8828,498.5,2159.8828,494.5,2155.8828" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="494.5" y="2137.8169">pushLDS</text><polygon fill="#383838" points="1259.5,2181.0156,1269.5,2185.0156,1259.5,2189.0156,1263.5,2185.0156" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="487.5" x2="1265.5" y1="2185.0156" y2="2185.0156"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="494.5" y="2179.9497">send(DiscoveryResponse)</text><polygon fill="#383838" points="1584,2210.1484,1594,2214.1484,1584,2218.1484,1588,2214.1484" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1271.5" x2="1590" y1="2214.1484" y2="2214.1484"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="1278.5" y="2209.0825">DiscoveryResponse</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="410" x2="1633.5" y1="2223.1484" y2="2223.1484"/><text fill="#000000" font-family="FG Virgil" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="123" x="415" y="2233.3589">[Endpoint Request]</text><line style="stroke: #383838; stroke-width: 1.0;" x1="487.5" x2="529.5" y1="2258.0859" y2="2258.0859"/><line style="stroke: #383838; stroke-width: 1.0;" x1="529.5" x2="529.5" y1="2258.0859" y2="2271.0859"/><line style="stroke: #383838; stroke-width: 1.0;" x1="488.5" x2="529.5" y1="2271.0859" y2="2271.0859"/><polygon fill="#383838" points="498.5,2267.0859,488.5,2271.0859,498.5,2275.0859,494.5,2271.0859" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="494.5" y="2253.02">pushEDS</text><polygon fill="#383838" points="1259.5,2296.2188,1269.5,2300.2188,1259.5,2304.2188,1263.5,2300.2188" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="487.5" x2="1265.5" y1="2300.2188" y2="2300.2188"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="494.5" y="2295.1528">send(DiscoveryResponse)</text><polygon fill="#383838" points="1584,2325.3516,1594,2329.3516,1584,2333.3516,1588,2329.3516" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1271.5" x2="1590" y1="2329.3516" y2="2329.3516"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="1278.5" y="2324.2856">DiscoveryResponse</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="410" x2="1633.5" y1="2338.3516" y2="2338.3516"/><text fill="#000000" font-family="FG Virgil" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="103" x="415" y="2348.562">[Route Request]</text><line style="stroke: #383838; stroke-width: 1.0;" x1="487.5" x2="529.5" y1="2373.2891" y2="2373.2891"/><line style="stroke: #383838; stroke-width: 1.0;" x1="529.5" x2="529.5" y1="2373.2891" y2="2386.2891"/><line style="stroke: #383838; stroke-width: 1.0;" x1="488.5" x2="529.5" y1="2386.2891" y2="2386.2891"/><polygon fill="#383838" points="498.5,2382.2891,488.5,2386.2891,498.5,2390.2891,494.5,2386.2891" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="494.5" y="2368.2231">pushRoute</text><polygon fill="#383838" points="1259.5,2411.4219,1269.5,2415.4219,1259.5,2419.4219,1263.5,2415.4219" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="487.5" x2="1265.5" y1="2415.4219" y2="2415.4219"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="494.5" y="2410.356">send(DiscoveryResponse)</text><polygon fill="#383838" points="1584,2440.5547,1594,2444.5547,1584,2448.5547,1588,2444.5547" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1271.5" x2="1590" y1="2444.5547" y2="2444.5547"/><text fill="#000000" font-family="FG Virgil" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="1278.5" y="2439.4888">DiscoveryResponse</text><!--MD5=[c11612a26ba99a3ff7c8c4b7345197d5]
@startuml
skinparam monochrome true
skinparam packageStyle rect
skinparam defaultFontName FG Virgil
skinparam shadowing false

queue ReqChannel
queue PushChannel
queue PushQueue
queue XdsConnection.pushChannel

participant "PilotServer"
participant ConfigController
participant ServiceController
participant DiscoveryServer
participant PushChannel
participant PushQueue
participant XdsConnection.pushChannel
participant XdsConnection
participant ReqChannel
participant "GRPC Server"
participant Envoy

== Initialization ==
note right of PilotServer
    pilot/pkg/bootstrap/server.go
end note
PilotServer -> ConfigController:Create
PilotServer -> ServiceController:Create
PilotServer -> DiscoveryServer:Create

DiscoveryServer -> ConfigController:RegisterEventHandler
DiscoveryServer -> ServiceController:AppendServiceHandler
DiscoveryServer -> ServiceController:AppendInstanceHandler

== Receive Connections ==
PilotServer -> "GRPC Server":Create
DiscoveryServer -> "GRPC Server":RegisterService
note left
    pilot/pkg/proxy/envoy/v2/discovery.go
    DiscoveryServer.Register
end note
...  ...
Envoy -> "GRPC Server":GRPC
"GRPC Server" -> DiscoveryServer:callback
note left
    pilot/pkg/proxy/envoy/v2/ads.go
    DiscoveryServer.StreamAggregatedResources
end note
DiscoveryServer -> XdsConnection:Create

== Service Change ==

ServiceController - -> DiscoveryServer:ConfigUpdate
activate DiscoveryServer
DiscoveryServer -> PushChannel:PushRequest(ServiceEntry)
deactivate DiscoveryServer

== Config Change ==
ConfigController - -> DiscoveryServer:ConfigUpdate
activate DiscoveryServer
DiscoveryServer -> PushChannel:PushRequest(Routing Rules, etc.)
deactivate DiscoveryServer

== debounce  ==
DiscoveryServer -> PushChannel:GetPushRequest
note left
    pilot/pkg/proxy/envoy/v2/discovery.go
    DiscoveryServer.debounce
end note
activate DiscoveryServer
return PushRequest
DiscoveryServer -> DiscoveryServer:MergePushRequest
DiscoveryServer -> PushQueue:Enqueue(XdsConnection,PushRequest)
deactivate DiscoveryServer

== sendPushes  ==
DiscoveryServer -> PushQueue:Dequeue
note left
    pilot/pkg/proxy/envoy/v2/discovery.go
    DiscoveryServer.sendPushes
end note
activate DiscoveryServer
return XdsConnection,PushRequest
DiscoveryServer -> XdsConnection.pushChannel:XdsEvent
deactivate DiscoveryServer

... ...
DiscoveryServer -> XdsConnection.pushChannel:GetPushEvent
note left
    pilot/pkg/proxy/envoy/v2/ads.go
    DiscoveryServer.StreamAggregatedResources
end note
activate DiscoveryServer
return PushEvent

DiscoveryServer -> DiscoveryServer:pushConnection(XdsConnection,PushRequest)
activate DiscoveryServer
DiscoveryServer -> DiscoveryServer:pushCDS
DiscoveryServer -> XdsConnection:send(DiscoveryResponse)
XdsConnection -> Envoy:DiscoveryResponse

DiscoveryServer -> DiscoveryServer:pushEDS
DiscoveryServer -> XdsConnection:send(DiscoveryResponse)
XdsConnection -> Envoy:DiscoveryResponse

DiscoveryServer -> DiscoveryServer:pushLDS
DiscoveryServer -> XdsConnection:send(DiscoveryResponse)
XdsConnection -> Envoy:DiscoveryResponse

DiscoveryServer -> DiscoveryServer:pushRoute
DiscoveryServer -> XdsConnection:send(DiscoveryResponse)
XdsConnection -> Envoy:DiscoveryResponse

deactivate DiscoveryServer
deactivate DiscoveryServer

== client Request  ==
Envoy -> XdsConnection: DiscoveryRequest
DiscoveryServer -> XdsConnection: Receive
note left
    pilot/pkg/proxy/envoy/v2/ads.go
    receiveThread
end note
return DiscoveryRequest
DiscoveryServer -> ReqChannel: DiscoveryRequest
... ...

DiscoveryServer -> ReqChannel: GetRequest
note left
    pilot/pkg/proxy/envoy/v2/ads.go
    StreamAggregatedResources
end note
activate DiscoveryServer
return DiscoveryRequest

alt Cluster Type
DiscoveryServer -> DiscoveryServer:pushCDS
DiscoveryServer -> XdsConnection:send(DiscoveryResponse)
XdsConnection -> Envoy:DiscoveryResponse

else Listener Request
DiscoveryServer -> DiscoveryServer:pushLDS
DiscoveryServer -> XdsConnection:send(DiscoveryResponse)
XdsConnection -> Envoy:DiscoveryResponse

else Endpoint Request
DiscoveryServer -> DiscoveryServer:pushEDS
DiscoveryServer -> XdsConnection:send(DiscoveryResponse)
XdsConnection -> Envoy:DiscoveryResponse

else Route Request
DiscoveryServer -> DiscoveryServer:pushRoute
DiscoveryServer -> XdsConnection:send(DiscoveryResponse)
XdsConnection -> Envoy:DiscoveryResponse
end
deactivate DiscoveryServer
@enduml

PlantUML version 1.2019.11(Sun Sep 22 10:02:15 UTC 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.7.0_25-b15
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>